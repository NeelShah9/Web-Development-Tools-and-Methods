(this["webpackJsonpfinal-project"]=this["webpackJsonpfinal-project"]||[]).push([[0],[,,,function(e,t,n){e.exports=n.p+"static/media/unavailable.07259c5a.jpg"},,,function(e,t,n){e.exports=n.p+"static/media/spinner.7c332d23.svg"},function(e,t,n){e.exports=n(14)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(5),o=n.n(r),i=(n(12),n(1)),l=function(){return Promise.reject({error:"NETWORK_ERROR"})},s=function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))},u=function(e){var t="https://api.themoviedb.org/3/find/".concat(e,"?api_key=c946c30088ad16d4120dcc22233c5fdc&language=en-US&external_source=imdb_id");return fetch(t,{method:"GET"}).catch(l).then(s)},m={DEFAULT:"Oh no!  Something went wrong, please try again",USERNAME_REQUIRED:"Username is required",LACK_KEYWORD:"Please enter a more specific key word",NETWORK_ERROR:"There was a problem reaching your network, please try again",NOT_ACCEPTABLE:'Your username cannot include "dog" or empty space, please log in with another name',LOGIN_REQUIRED:"Login to start Surfin'",LOGIN_UNAUTHORIZED:"This content is only accessible to logged in users",MESSAGE_REQUIRED:"Comments cannot be empty.",SHOW_NOT_FOUND:"Tv show not found. Please try a better keyword."},d=c.a.createContext({default:"doesn't matter"}),h=c.a.createContext({default:"doesn't matter"}),f=n(6),E=n.n(f),b=function(e){var t=e.onLogin,n=Object(a.useState)(""),r=Object(i.a)(n,2),o=r[0],u=r[1],d=Object(a.useState)(!1),f=Object(i.a)(d,2),b=f[0],p=f[1],g=Object(a.useContext)(h),v=Object(i.a)(g,1)[0],O=function(e){e.preventDefault(),o?(v(""),p(!0),function(e){return fetch("/session",{method:"POST",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({username:e})}).catch(l).then(s)}(o).then((function(e){t(e.username)})).catch((function(e){v(m[e.error||"DEFAULT"]),p(!1)}))):v(m.USERNAME_REQUIRED)};return c.a.createElement("div",{className:"login"},c.a.createElement("form",{onSubmit:function(e){return O(e)}},c.a.createElement("input",{onChange:function(e){return u(e.target.value)}}),b?c.a.createElement("img",{alt:"spinner",src:E.a}):c.a.createElement("button",{type:"submit",disabled:!o},"Login")))},p=function(e){var t=e.onLogout,n=Object(a.useContext)(h),r=Object(i.a)(n,2),o=(r[0],r[1]);return c.a.createElement("button",{className:"header-btn",onClick:function(){fetch("/session",{method:"DELETE"}).catch(l).then((function(e){return e.ok})).then((function(){t()})).catch((function(e){o(m[e.error||"DEFAULT"])}))}}," ","Log out"," ")},g=n(2),v=function(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),n=t[0],r=t[1],o=Object(a.useContext)(d),u=Object(i.a)(o,2),f=u[0],E=u[1],b=Object(a.useContext)(h),p=Object(i.a)(b,1)[0];Object(a.useEffect)((function(){fetch("https://api.themoviedb.org/3/tv/top_rated?api_key=c946c30088ad16d4120dcc22233c5fdc&language=en-US&page=1",{method:"GET"}).catch(l).then(s).then((function(e){r(e.results.slice(0,10))})).catch((function(e){p(m[e.message||"DEFAULT"])}))}),[]);var v=function(e){E(Object(g.a)({},f,{id:e}))},O=n.map((function(e){return c.a.createElement("li",{key:n.indexOf(e),className:"top-tv"},c.a.createElement("img",{src:"https://image.tmdb.org/t/p/w500"+e.poster_path,className:"clickable",onClick:function(){return v(e.id)},alt:"poster"}),c.a.createElement("p",{className:"clickable",onClick:function(){return v(e.id)}}," ",e.title," "),c.a.createElement("p",{className:"time"}," ",e.release_date," "),c.a.createElement("p",{className:"rating"}," Rating: ",e.vote_average," "),c.a.createElement("button",{onClick:function(){return v(e.id)}}," details"))}));return c.a.createElement("div",null,c.a.createElement("h2",null," Top Ten TV Shows: "),c.a.createElement("ol",{className:"top-rated-tvs"},O))},O=n(3),j=n.n(O),T=function(){var e=Object(a.useContext)(d),t=Object(i.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)([]),f=Object(i.a)(o,2),E=f[0],b=f[1],p=Object(a.useContext)(h),v=Object(i.a)(p,1)[0];Object(a.useEffect)((function(){n.id?(O(n.id),v("")):u(n.imdbID).then((function(e){var t=e.tv_results[0].id;O(t)})).catch((function(e){v(m[e.error||"DEFAULT"])}))}),[n.imdbID,n.id]);var O=function(e){return function(e){var t="https://api.themoviedb.org/3/tv/".concat(e,"/recommendations?api_key=c946c30088ad16d4120dcc22233c5fdc&language=en-US&page=1");return fetch(t,{method:"GET"}).catch(l).then(s)}(e).then((function(e){b(e.results.slice(0,4)),v("")})).catch((function(e){v(m[e.error||"DEFAULT"])}))},T=function(e){r(Object(g.a)({},n,{id:e}))},N=E.map((function(e){var t;return t=e.poster_path?c.a.createElement("img",{src:"https://image.tmdb.org/t/p/w500/"+e.poster_path,className:"clickable",onClick:function(){return T(e.id)},alt:"poster"}):c.a.createElement("img",{src:j.a,alt:"poster unavailable",className:"clickable",onClick:function(){return T(e.id)}}),c.a.createElement("li",{key:E.indexOf(e)},c.a.createElement("p",{className:"clickable",onClick:function(){return T(e.id)}},e.title),c.a.createElement("p",{className:"time"}," ",e.release_date," "),c.a.createElement("p",{className:"rating"}," Rating: ",e.vote_average," "),t,c.a.createElement("p",null,c.a.createElement("button",{onClick:function(){return T(e.id)}}," details")))}));return c.a.createElement("div",null,c.a.createElement("h2",null,"Since you liked ",c.a.createElement("span",{className:"highlight-title"},n.Title)," :"),c.a.createElement("ul",{className:"recommendation"},N))},N=function(){var e=Object(a.useContext)(d),t=Object(i.a)(e,2),n=t[0],r=t[1],o=Object(a.useContext)(h),f=Object(i.a)(o,1)[0],E=Object(a.useState)(""),b=Object(i.a)(E,2),p=b[0],v=b[1],O=Object(a.useState)(""),N=Object(i.a)(O,2),w=N[0],S=N[1];Object(a.useEffect)((function(){window.scrollTo(0,0),n.id?(v(""),k(n.id)):u(n.imdbID).then((function(e){if(0===e.tv_results.length)throw new Error("LACK_KEYWORD");var t=e.tv_results[0].id;r(Object(g.a)({},n,{id:t})),v(""),f("")})).catch((function(e){f(m[e.error||e.message||"DEFAULT"])}))}),[n.id,n.imdbID]);var _,k=function(e){return function(e){var t="https://api.themoviedb.org/3/tv/".concat(e,"?api_key=c946c30088ad16d4120dcc22233c5fdc&language=en-US");return fetch(t,{method:"GET"}).catch(l).then(s)}(e).then((function(e){r({Title:e.name,Year:e.first_air_date,imdbID:e.tvdb_id,id:e.id,overview:e.overview,PosterUrl:"https://image.tmdb.org/t/p/w500/"+e.poster_path}),function(e){return fetch("/comments/".concat(e),{method:"GET"}).catch(l).then(s)}(e.id).then((function(e){S(e.comment)})),f("")})).catch((function(e){f(m[e.error||e||"DEFAULT"])}))},D=function(e){e.preventDefault(),function(e,t){return fetch("/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,comment:t})}).catch(l).then(s)}(n.id,p).then((function(e){S(e.comment),v("")})).catch((function(e){f(m[e.error||e||"DEFAULT"])}))};return _=n.PosterUrl&&"https://image.tmdb.org/t/p/w500/N/A"!==n.PosterUrl?c.a.createElement("img",{src:n.PosterUrl,alt:"poster"}):c.a.createElement("img",{src:j.a,alt:"poster unavailable"}),c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"flex-box"},c.a.createElement("div",{className:"result-detail"},c.a.createElement("p",{className:"title"}," Title: ",n.Title," "),c.a.createElement("p",{className:"time"}," Year: ",n.Year," "),c.a.createElement("p",{className:"overview"}," ","Overview: ",n.overview||"Not Available"),c.a.createElement("p",null,"My comment:",w)," ",c.a.createElement("button",{onClick:function(){var e;(e=n.id,fetch("/comments/".concat(e),{method:"DELETE"}).catch(l).then(s)).then((function(e){S("")})).catch((function(e){f(m[e.error||e||"DEFAULT"])}))},disabled:!w},"delete"),c.a.createElement("form",{onSubmit:function(e){return D(e)}},c.a.createElement("label",null,"New Comment:",c.a.createElement("input",{value:p,onChange:function(e){return function(e){v(e.target.value)}(e)}})),c.a.createElement("button",{type:"submit"},"comment/edit"))),c.a.createElement("div",{className:"img-detail"},_)),c.a.createElement(T,null))},w=function(){var e,t=Object(a.useContext)(d),n=Object(i.a)(t,2),r=n[0],o=n[1],f=Object(a.useContext)(h),E=Object(i.a)(f,1)[0],b=function(e){var t;e.preventDefault(),(t=r.keyword,fetch("http://www.omdbapi.com/?type=series&apikey=94e9f017&s="+t,{method:"GET"}).catch(l).then(s)).then((function(e){if(e.Error)throw new Error("SHOW_NOT_FOUND");u(e.Search[0].imdbID).then((function(t){if(0===t.tv_results.length)throw new Error("LACK_KEYWORD");var n=t.tv_results[0].id;o({imdbID:e.Search[0].imdbID,Title:e.Search[0].Title,Year:e.Search[0].Year,PosterUrl:e.Search[0].Poster,id:n})}))})).catch((function(e){E(m[e.error||e.message||"DEFAULT"]),o({})}))};return e=r.imdbID||r.id?c.a.createElement(N,null):c.a.createElement(v,null),console.log(r),c.a.createElement("div",null,c.a.createElement("form",{onSubmit:function(e){return b(e)},className:"search-panel"},c.a.createElement("input",{type:"text",value:r.keyword||"",placeholder:"Search...",onChange:function(e){return function(e){o(Object(g.a)({},r,{keyword:e.target.value}))}(e)}}),c.a.createElement("button",{type:"submit",disabled:!r.keyword}," ","Search"," ")),e)},S=function(){var e=Object(a.useContext)(d),t=Object(i.a)(e,2),n=(t[0],t[1]);return c.a.createElement("button",{className:"header-btn",onClick:function(){n({})}},"Homepage")};n(13);var _=function(){var e,t=Object(a.useState)({isLoggedIn:!1}),n=Object(i.a)(t,2),r=n[0],o=n[1],u=Object(a.useState)({}),f=Object(i.a)(u,2),E=f[0],g=f[1],v=Object(a.useState)(),O=Object(i.a)(v,2),j=O[0],T=O[1];return Object(a.useEffect)((function(){fetch("/session",{method:"GET"}).catch(l).then(s).then((function(e){o({isLoggedIn:!0,username:e.username})})).catch((function(e){T(m[e.error||e||"DEFAULT"])}))}),[r.username]),e=r.isLoggedIn?c.a.createElement(d.Provider,{value:[E,g]},c.a.createElement("div",{className:"header"},c.a.createElement(S,null),c.a.createElement(p,{onLogout:function(){o({isLoggedIn:!1})}})),c.a.createElement(w,null)):c.a.createElement("div",null,c.a.createElement(b,{onLogin:function(e){o({isLoggedIn:!0,username:e})}})),c.a.createElement("div",{className:"App"},c.a.createElement("h1",null,"WebTv"),c.a.createElement("p",{className:"error"},j),c.a.createElement(h.Provider,{value:[T]},e))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(_,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[7,1,2]]]);
//# sourceMappingURL=main.49aa0675.chunk.js.map